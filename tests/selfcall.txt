#define str_self struct string*

typedef struct string {
    int   size;
    char* body;
    __attribute__((selfcall)) int   (*get_size)(str_self);
    __attribute__((selfcall)) char* (*get_body)(str_self);
    __attribute__((selfcall)) int   (*set_body)(str_self, char*);
} string_t;

int main() {
    string_t s;
    void* b = &s;
    
    ((string_t*)b)->get_size(&s);
    ((string_t*)b)->get_body(&s);
    ((string_t*)b)->set_body(&s, "Hello world!);

    ((string_t*)b)->get_size();
    ((string_t*)b)->get_body();
    ((string_t*)b)->set_body("Hello world!");
    
    return 1;
}
